Implementing the migration in phases.