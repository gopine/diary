I improved the performance by implementing throttling in some functions.